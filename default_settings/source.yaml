# 第一组：Python 基础 Source 规则
- lang: python
  rules:
    - operation: call_stmt
      name: source
      tag: ["%target"]  # 规范引号，移除多余空格
# ######################################## 适配污点使用，勿删 ################################################
# 25个CVE的source变量
# 第二组：Java CVE 相关 Source 规则
- lang: java
  rules:
    # CVE-2023-43654
    - operation: parameter_decl
      name: req
      line_num: 35
      unit_name: HttpRequestHandler.java
    # CVE-2023-48299（同上，保留注释）
    - operation: parameter_decl
      name: req  # 沿用上方CVE-2023-43654的配置，可根据实际需求修改
      line_num: 35
      unit_path: "/home/rong/llm-driven-sec/tests/realcases/CVE-2023-43654/test/serve-0.8.0/frontend/server/src/main/java/org/pytorch/serve/http/HttpRequestHandler.java"

# 第三组：Python CVE 相关 Source 规则
- lang: python
  rules:
    - operation: call_stmt
      name: source
      tag: [ "%target" ]  # 规范引号，移除多余空格
    # CVE-2023-51449
    - operation: parameter_decl
      name: path_or_url
      line_num: 434
      unit_name: routes.py
    # CVE-2023-6730
    - operation: parameter_decl
      name: retriever_name_or_path
      line_num: 419
      unit_name: retrieval_rag.py
    # CVE-2023-7018
    - operation: parameter_decl
      name: pretrained_model_name_or_path
      line_num: 592
      unit_name: tokenization_auto.py
    # CVE-2024-10044
    - operation: parameter_decl
      name: request
      line_num: 337
      unit_path: "/home/rong/llm-driven-sec/tests/realcases/CVE-2024-10044/test/FastChat/fastchat/serve/controller.py"
    # CVE-2024-10099
    - operation: parameter_decl
      name: request
      line_num: 258
      unit_name: server.py
    - operation: parameter_decl
      name: request
      line_num: 307
      unit_name: server.py
    # CVE-2024-10457
    - operation: parameter_decl
      name: node_input
      line_num: 522
      unit_path: "/home/rong/llm-driven-sec/tests/realcases/CVE-2024-10457/test/AutoGPT-0.1.1/autogpt_platform/backend/backend/server/rest_api.py"
    - operation: field_read
      name: "%this.queue"
      line_num: 705
      unit_name: manager.py
      tag: ["%target"]
    # CVE-2024-10940
    - operation: parameter_decl
      name: template
      line_num: 491
      unit_path: "/home/rong/llm-driven-sec/tests/realcases/CVE-2024-10940/test/langchain-langchain-core-0.3.14/libs/core/langchain_core/prompts/chat.py"
    - operation: parameter_decl
      name: input
      line_num: 192
      unit_path: "/home/rong/llm-driven-sec/tests/realcases/CVE-2024-10940/test/langchain-langchain-core-0.3.14/libs/core/langchain_core/prompts/base.py"
    # CVE-2024-11041
    - operation: object_call
      name: \%this.remote_socket.recv  # 规范引号，移除多余反斜杠（YAML中无需转义%）
      line_num: 442
      unit_path: "/home/rong/llm-driven-sec/tests/realcases/CVE-2024-11041/test/vllm-0.6.2/vllm/distributed/device_communicators/shm_broadcast.py"
      tag: ["%target"]
    # CVE-2024-11042
    - operation: parameter_decl
      name: image_names
      line_num: 346  # 修正原始错误：移除"l ine_num"中的多余空格
      unit_path: "/home/rong/llm-driven-sec/tests/realcases/CVE-2024-11042/test/InvokeAI-5.0.2/invokeai/app/api/routers/images.py"
    # CVE-2024-11958
    - operation: parameter_decl
      name: str_or_query_bundle
      line_num: 222
      unit_path: "/home/rong/llm-driven-sec/tests/realcases/CVE-2024-11958/test/llama_index-0.12.2/llama-index-core/llama_index/core/base/base_retriever.py"
    # CVE-2024-12029
    - operation: parameter_decl
      name: source
      line_num: 450
      unit_path: "/home/rong/llm-driven-sec/tests/realcases/CVE-2024-12029/test/InvokeAI-5.3.1/invokeai/app/api/routers/model_manager.py"
    - operation: object_call
      name: \%this._queue.get  # 规范引号，移除多余反斜杠
      line_num: 280
      unit_path: "/home/rong/llm-driven-sec/tests/realcases/CVE-2024-12029/test/InvokeAI-5.3.1/invokeai/app/services/download/download_default.py"
      tag: ["%target"]
    # CVE-2024-1558
    - operation: parameter_decl
      name: flask_request
      line_num: 421
      unit_path: "/home/rong/llm-driven-sec/tests/realcases/CVE-2024-1558/test/mlflow-2.11.3/mlflow/server/handlers.py"
    - operation: object_call
      name: request.query_string.decode  # 规范引号，移除多余反斜杠
      line_num: 1786
      unit_path: "/home/rong/llm-driven-sec/tests/realcases/CVE-2024-1558/test/mlflow-2.11.3/mlflow/server/handlers.py"
      tag: ["%target"]
    # CVE-2024-23731
    - operation: parameter_decl
      name: data_type
      line_num: 139
      unit_path: "/home/rong/llm-driven-sec/tests/realcases/CVE-2024-23731/test/mem0-0.1.56/embedchain/embedchain.py"
    # CVE-2024-34359
    - operation: parameter_decl
      name: model_path
      line_num: 66
      unit_path: "/home/rong/llm-driven-sec/tests/realcases/CVE-2024-34359/test/llama-cpp-python-0.2.71/llama_cpp/llama.py"
    - operation: field_read
      name: \%this.chat_handler  # 规范引号，移除多余反斜杠
      line_num: 1722
      unit_path: "/home/rong/llm-driven-sec/tests/realcases/CVE-2024-34359/test/llama-cpp-python-0.2.71/llama_cpp/llama.py"
    # CVE-2024-4325
    - operation: parameter_decl
      name: request
      line_num: 654
      unit_path: "/home/rong/llm-driven-sec/tests/realcases/CVE-2024-4325/test/gradio-4.21.0/gradio/routes.py"
    - operation: field_read
      name: \%this.event_queue_per_concurrency_id  # 规范引号，移除多余反斜杠
      line_num: 246
      unit_path: "/home/rong/llm-driven-sec/tests/realcases/CVE-2024-4325/test/gradio-4.21.0/gradio/queueing.py"
    # CVE-2024-4941
    - operation: parameter_decl
      name: body
      line_num: 668
      unit_path: "/home/rong/llm-driven-sec/tests/realcases/CVE-2024-4941/test/gradio-4.25.0/gradio/routes.py"
    # CVE-2024-5980
    - operation: parameter_decl
      name: run
      line_num: 128
      unit_path: "/home/rong/llm-driven-sec/tests/realcases/CVE-2024-5980/test/pytorch-lightning-2.2.4/src/lightning/app/plugin/plugin.py"
    # CVE-2024-8953
    - operation: parameter_decl
      name: request
      line_num: 196
      unit_path: "/home/rong/llm-driven-sec/tests/realcases/CVE-2024-8953/test/composio-0.4.3/python/composio/server/api.py"
    # CVE-2024-9053
    - operation: object_call
      name: \%this.socket.recv_multipart # 规范引号，移除多余反斜杠
      line_num: 198
      unit_path: "/home/rong/llm-driven-sec/tests/realcases/CVE-2024-9053/test/vllm-0.6.0/vllm/entrypoints/openai/rpc/server.py"
      tag: ["%target"]
    # CVE-2025-1040
    - operation: parameter_decl
      name: data
      line_num: 117
      unit_path: "/home/rong/llm-driven-sec/tests/realcases/CVE-2025-1040/test/AutoGPT-autogpt-platform-beta-v0.3.4/autogpt_platform/backend/backend/server/routers/v1.py"
    # CVE-2025-24357
    - operation: parameter_decl
      name: model
      line_num: 152
      unit_path: "/home/rong/llm-driven-sec/tests/realcases/CVE-2025-24357/test/vllm-0.6.6/vllm/entrypoints/llm.py"
    # CVE-2025-25362
    - operation: parameter_decl
      name: docs
      line_num: 57
      unit_path: "/home/rong/llm-driven-sec/tests/realcases/CVE-2025-25362/test/spacy-llm-0.7.2/spacy_llm/tasks/builtin_task.py"
    # CVE-2025-32375
    - operation: parameter_decl
      name: request
      line_num: 291
      unit_path: "/home/rong/llm-driven-sec/tests/realcases/CVE-2025-32375/test/BentoML-1.4.7/src/bentoml/_internal/server/runner_app.py"
